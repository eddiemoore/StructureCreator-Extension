package com.asfug.structurecreator{	import flash.display.*;	import flash.events.*;	import flash.net.*;	import flash.text.TextField;		/**	 * ...	 * @author Danny Murong	 * @modified Ed Moore	 */	public class FileCreate	{		private var _stage:MovieClip;		private var _fileNameExtension:String;		private var _folderURI:String;		private var _urlLoader:URLLoader;				public function FileCreate(stage:MovieClip, fileNameExtension:String, folderURI:String, fileURL:String = '', fileContents:String = '')		{			//(stage.getChildByName('info_txt') as TextField).htmlText += fileNameExtension + ' ::: ' + folderURI + ' ::: ' + fileURL +'\n';			_stage = stage;			_fileNameExtension = fileNameExtension;			_folderURI = folderURI;						//(_stage.getChildByName('info_txt') as TextField).htmlText += fileNameExtension + ' ::: ' + folderURI + ' ::: ' + fileURL +'\n';						if (fileURL == '')			{				createFile(fileContents);			}			else			{				if (fileURL.indexOf('http:') == -1 && fileURL.indexOf('https:') == -1 && fileURL.indexOf('file:') == -1)				{					fileURL = _stage.executeJSFL('"getConfigURI"') + "StructureCreator/" + fileURL;				}				_urlLoader = new URLLoader(new URLRequest(fileURL));				_urlLoader.addEventListener(Event.COMPLETE, completeHandler);			}		}				private function completeHandler(evt:Event)		{			var stringData:String = _urlLoader.data;			createFile(stringData);		}				private function createFile(stringData:String = ''):void 		{			stringData = stringData.replace(/%SWFWIDTH%/g, StructureCreator.instance.width_txt.text);			stringData = stringData.replace(/%SWFHEIGHT%/g, StructureCreator.instance.height_txt.text);						var w:int = int(StructureCreator.instance.width_txt.text) * 0.5;			var h:int = int(StructureCreator.instance.height_txt.text) * 0.5;			stringData = stringData.replace(/%SWFHALFWIDTH%/g, w);			stringData = stringData.replace(/%SWFHALFHEIGHT%/g, h);						stringData = stringData.replace(/%SWFNAME%/g, StructureCreator.swfFileName);			stringData = stringData.replace(/%SWFFPS%/g, StructureCreator.instance.framerate_txt.text);						stringData = stringData.replace(/%PACKAGENAME%/g, StructureCreator.packageClassPath);			stringData = stringData.replace(/%CLASSNAME%/g, _fileNameExtension.split('.')[0]);			stringData = stringData.replace(/%PROJECTNAME%/g, StructureCreator.instance.projectname_txt.text);						stringData = escape(stringData);			StructureCreator.instance.info_txt.htmlText += _stage.executeJSFL('"createFile", "' + _folderURI + '", "' + _fileNameExtension + '", "' + stringData + '"') + "\n";			//(_stage as StructureCreator).updatePercent();			StructureCreator.instance.updatePercent();		}	}	}